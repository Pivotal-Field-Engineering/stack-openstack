---
# Knife plugins for VM creation and bootstrapping

# OpenStack Vagrant VMs use subnet 192.168.60.0/24 for
# management traffic and subnet 192.168.61.0/24 for data
vagrant_ubuntu_1404:
  create_1nic_768M:
    class: Chef::Knife::VagrantServerCreate
    synchronized: true
    name_key: chef_node_name
    options:
      vagrant_dir: ~/.vagrant
      provider: virtualbox
      box: chef/ubuntu-14.04
      box_url: https://vagrantcloud.com/chef/boxes/ubuntu-14.04
      memsize: 768
      subnet: 192.168.60.0/25
      port_forward: {}
      share_folders: []
      use_cachier: false
      distro: chef-full
      host_key_verify: false
      ssh_port: 22
      inline_config: |
        config.ohai.enable = true
        config.ohai.primary_nic = "eth1"
        config.vm.provision "shell", inline: "mkdir -p /etc/chef"
        config.vm.provision "shell", inline: "apt-get update"
      run_list:
      - recipe[ohai]
  create_1nic_4G:
    class: Chef::Knife::VagrantServerCreate
    synchronized: true
    name_key: chef_node_name
    options:
      vagrant_dir: ~/.vagrant
      provider: virtualbox
      box: chef/ubuntu-14.04
      box_url: https://vagrantcloud.com/chef/boxes/ubuntu-14.04
      memsize: 4096
      subnet: 192.168.60.0/25
      port_forward: {}
      share_folders: []
      use_cachier: false
      distro: chef-full
      host_key_verify: false
      ssh_port: 22
      vb_customize: >
        'createhd', '--filename', './cinder_volume.vdi', '--size', 20 * 1024::
        "storagectl", :id, "--name", "SATA Controller", "--add", "sata"::
        'storageattach', :id, '--storagectl', "SATA Controller", '--port', 1, '--device', 0, '--type', 'hdd', '--medium', './cinder_volume.vdi'
      inline_config: |
        config.ohai.enable = true
        config.ohai.primary_nic = "eth1"
        config.vm.provision "shell", inline: "mkdir -p /etc/chef"
        config.vm.provision "shell", inline: "apt-get update"
      run_list:
      - recipe[ohai]
  create_2nic_2G:
    class: Chef::Knife::VagrantServerCreate
    synchronized: true
    name_key: chef_node_name
    options:
      vagrant_dir: ~/.vagrant
      provider: virtualbox
      box: chef/ubuntu-14.04
      box_url: https://vagrantcloud.com/chef/boxes/ubuntu-14.04
      memsize: 2048
      subnet: 192.168.60.0/25
      port_forward: {}
      share_folders: []
      use_cachier: false
      distro: chef-full
      host_key_verify: false
      ssh_port: 22
      inline_config: |
        config.vm.network "private_network", :auto_config => false, ip: "192.168.61.0"
        config.ohai.enable = true
        config.ohai.primary_nic = "eth1"
        config.vm.provision "shell", inline: "mkdir -p /etc/chef"
        config.vm.provision "shell", inline: "apt-get update"
      run_list:
      - recipe[ohai]
  delete:
    class: Chef::Knife::VagrantServerDelete
    options:
      vagrant_dir: ~/.vagrant
      "yes": true
